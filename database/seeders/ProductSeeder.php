<?php

namespace Database\Seeders;

use Illuminate\Database\Seeder;
use Illuminate\Support\Facades\DB;

class ProductSeeder extends Seeder
{
    public function run(): void
    {
        // ดึง id ของหมวดตามชื่อ
        $catId = fn(string $name) =>
            DB::table('product_categories')->where('name', $name)->value('id');

        $now = now();

        $items = [
            // ===== เสาไฟ =====
            ['c' => 'เสาไฟ', 'name' => 'เสาไฟ 4 เมตร (แบบเทเปอร์) 3.2 มม. ฐาน 30 มม.',         'sku' => '9701-013-09', 'lot' => 'LP4 6807-001'],
            ['c' => 'เสาไฟ', 'name' => 'เสาไฟ 6 เมตร (แบบเทเปอร์) 4 มม. ฐาน 30 มม.',            'sku' => '9706-013-07', 'lot' => 'LP6 6807-002'],
            ['c' => 'เสาไฟ', 'name' => 'เสาไฟ 7 เมตร (แบบเทเปอร์)',                              'sku' => '9706-013-??', 'lot' => 'LP7 6807-003'], // ใส่ sku จริงถ้ามี
            ['c' => 'เสาไฟ', 'name' => 'เสาไฟ 9 เมตร (แบบเทเปอร์) 4.0 มม. ฐาน 25 มม.',         'sku' => '9706-060-01', 'lot' => 'LP9 (4.0) 6807-004'],
            ['c' => 'เสาไฟ', 'name' => 'เสาไฟ 9 เมตร (แบบเทเปอร์) 4.0 มม. ฐาน 30 มม.',         'sku' => '9706-061-01', 'lot' => 'LP9 (4.0) 6807-005'],
            ['c' => 'เสาไฟ', 'name' => 'เสาไฟ 9 เมตร (แบบเทเปอร์) 4.5 มม. ฐาน 30 มม.',         'sku' => '9706-060-06', 'lot' => 'LP9 (4.5) 6807-006'],
            ['c' => 'เสาไฟ', 'name' => 'เสาไฟ 6 เมตร (แบบสี่เหลี่ยม) (กิ่งเดี่ยว)',              'sku' => '9706-013-11', 'lot' => 'LP6[] 6807-007'],
            ['c' => 'เสาไฟ', 'name' => 'เสาไฟ 6 เมตร (แบบสี่เหลี่ยม) (กิ่งคู่)',                  'sku' => '9706-013-12', 'lot' => 'LP6[] 6807-008'],
            ['c' => 'เสาไฟ', 'name' => 'เสาไฟ 6 เมตร (แบบท่อกลม) 101.6 มม. (กิ่งเดี่ยว)',        'sku' => '9706-013-09', 'lot' => 'LP6O 6807-009'],
            ['c' => 'เสาไฟ', 'name' => 'เสาไฟ 6 เมตร (แบบท่อกลม) 101.6 มม. (กิ่งคู่)',            'sku' => '9706-013-10', 'lot' => 'LP6O 6807-010'],

            // ===== ราวกั้นอันตราย =====
            ['c' => 'ราวกั้นอันตราย', 'name' => 'แผ่นราวกั้นอันตราย 3.2 มม.',                    'sku' => '9603-031-02', 'lot' => 'GR 3.2 6807-001'],
            ['c' => 'ราวกั้นอันตราย', 'name' => 'แผ่นราวกั้นอันตราย 2.5 มม.',                    'sku' => '9603-030-04', 'lot' => 'GR 2.5 6807-002'],

            // ===== สีเทอร์โมพลาสติก =====
            ['c' => 'สีเทอร์โมพลาสติก', 'name' => 'สีเทอร์โมพลาสติก (ขาว) 0%',                    'sku' => '9501-110-01', 'lot' => 'TH (W 0%)'],
            ['c' => 'สีเทอร์โมพลาสติก', 'name' => 'สีเทอร์โมพลาสติก (เหลือง) 0%',                 'sku' => '9501-210-01', 'lot' => 'TH (Y 0%)'],
            ['c' => 'สีเทอร์โมพลาสติก', 'name' => 'สีเทอร์โมพลาสติก (ขาว) 10%',                   'sku' => '9501-110-02', 'lot' => 'TH (W 10%)'],
            ['c' => 'สีเทอร์โมพลาสติก', 'name' => 'สีเทอร์โมพลาสติก (เหลือง) 10%',                'sku' => '9501-210-02', 'lot' => 'TH (Y 10%)'],
        ];

        $rows = [];
        foreach ($items as $i) {
            $rows[] = [
                'category_id' => $catId($i['c']),
                'name'        => $i['name'],
                'sku'         => $i['sku'],
                'lot_format'  => $i['lot'],
                'created_at'  => $now,
                'updated_at'  => $now,
            ];
        }

        DB::table('products')->insert($rows);
    }
}
